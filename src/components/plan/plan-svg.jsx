import React, { useMemo } from "react";
import { useStore } from "../../store";
import "./plan-svg.css";

const xmin = -13.535;
const ymin = -18.565;

const xmax = 16.165;
const ymax = 11.135;

const Parois = () => (
  <g>
    <path
      className="parois"
      id="parois"
      d="m 562.95898,157.70312 -7.04687,7.58985 -74.2832,80.0332 3.2207,3.89453 -70.26563,65.84571 -46.6914,-46.31055 -61.56446,-61.32031 -61.41406,55.49804 -116.10547,115.63477 90.65625,75.87305 -24.29492,23.58398 8.08008,6.09375 31.13672,-30.22852 -90.76367,-75.96289 108.17578,-107.73828 54.19531,-48.97265 54.84961,54.63086 53.54297,53.10742 84.16016,-78.86524 -3.62696,-4.38476 68.32227,-73.60938 33.85742,33.70703 15.52539,-15.36328 65.44922,57.74024 -12.69727,15.26562 47.89258,35.03321 41.25195,-34.32422 29.49414,-25.19141 32.1211,-32.11914 27.8125,27.71094 -8.5,10.28711 49.22656,58.46484 53.63867,66.23242 -25.50781,22.98633 28.56836,37.18555 -56.99609,42.29883 19.73437,28.13085 -39.57422,26.76563 -31.9082,20.46875 -16.79297,-28.44531 -7.34766,6.29687 7.87305,9.44727 -24.75586,17.32031 -6.41015,-11.03125 -27.61719,-46.08789 -11.1875,-13.46875 -20,20.4082 -9.41016,9.08008 7,7.14258 9.45508,-9.12305 12.3418,-12.59375 3.61718,4.35352 27.1875,45.37109 11.8418,20.37891 31.02539,-21.70508 9.84375,16.67578 40.7461,-26.13672 48.10156,-32.5332 -19.98633,-28.48633 57.34375,-42.55664 -29.13086,-37.91602 25.6875,-23.14843 -59.66992,-73.67774 -43.91602,-52.1582 8.99024,-10.88086 -41.33789,-41.18555 -38.90039,38.89844 -29.14649,24.89453 -35.20312,29.29102 -33.00196,-24.14063 12.10352,-14.55078 -79.74219,-70.34961 -15.11133,14.95508 z m 55.49414,219.70313 -69.67773,90.54102 -68.16797,104.14062 -4.63086,-0.8125 -4.95508,-0.2207 -9.7539,14.09179 -4.86914,7.9375 -14.16992,-7.97851 -14.37305,-9.85938 -70.2832,-65.73437 -42.625,40.35742 -54.41211,-66.6582 -25.54493,24.9414 7.28321,6.86524 17.42773,-17.01563 54.30469,66.5293 43.60742,-41.28906 63.96289,59.82226 15.36133,10.53711 22.94727,12.92188 9.76171,-15.91211 6.35352,-9.17969 9.36719,1.64453 71.5664,-109.33203 62.41797,-81.10742 14.19922,14.5332 -1.03516,9.57227 3.42579,15.88867 15.95312,22.71484 37.9043,-27.11914 12.33398,14.50586 -27.86133,24.03711 6.75977,7.375 35.15234,-30.32617 -24.72461,-29.07617 -37.17968,26.60156 -8.99024,-12.80078 -2.6582,-12.33008 L 644,403.55664 Z"
    />
  </g>
);

const Lignes = () => (
  <g>
    <path
      className="lignes"
      id="lignes"
      d="m 691.43483,414.72654 -22.42879,-26.71238 -2.4057,-0.58225 -4.44675,1.60276 -2.844,0.14716 -1.74669,-1.16767 -3.79093,-4.29959 -11.9134,-14.43426 -1.86505,-0.51825 -3.78453,1.51316 -4.14603,2.92076 -3.27905,2.12421 -3.28228,0.12156 -4.00843,-1.21567 -3.33985,-3.09672 -2.79603,-3.33984 -0.42225,-3.16069 0.54382,-3.8261 1.64115,-3.70454 2.67443,-3.40064 4.53312,-4.54272 -6.2958,-7.697 -8.48399,-7.17235 -13.29542,15.65633 -55.21945,76.56696 -56.07682,75.4185 -38.57138,56.59188 -4.63548,-2.79916 -13.90964,19.5048 m -42.08719,-208.78207 -0.59185,-1.3916 -14.47586,-16.14582 -11.87503,-12.72597 -3.55738,-1.07807 -23.03024,29.40281 -0.79978,1.68592 0.75819,1.73069 21.13318,21.93297 1.56116,0.21113 1.98342,-0.29433 17.9693,-12.23332 10.58577,-9.57485 z m 368.74283,-102.29756 23.73725,26.9248 m -64.98949,7.39757 -12.82514,13.48544 -6.49737,6.65026 -23.43009,-15.56804 -18.13564,-19.64848 3.02312,-7.25489 9.97478,-12.69622 m 143.10799,261.77144 -23.29257,15.73636 m -370.79664,-212.00039 24.81213,23.94196 57.35323,-50.22087 26.37009,-25.28207 74.17086,-71.58695 m 103.34011,106.15789 24.33544,19.79884 53.47919,-40.68185 31.31267,-22.04203 25.87423,-24.19534 m -25.87423,24.19534 48.88524,58.47549 54.3429,65.00866 m -96.96434,126.39915 68.53727,-46.91782"
    />
  </g>
);

const Escalier = () => (
  <g>
    <path
      className="escalier"
      id="escalier"
      d="m 316.75447,919.26107 c 26.36369,14.65502 52.72737,29.31004 79.09105,43.96507 m -133.1921,-79.02067 c -24.93091,-13.88619 -49.86184,-27.77234 -74.79275,-41.65852 m 166.03841,38.07874 c 3.12017,-3.14365 6.24037,-6.28726 9.36053,-9.43091 m -18.71786,18.86502 c 3.11911,-3.1447 6.23822,-6.28941 9.35733,-9.43411 m -18.71786,18.86502 c 3.12017,-3.14365 6.24037,-6.28726 9.36053,-9.43091 m -18.71786,18.86182 c 3.11911,-3.14365 6.23822,-6.28726 9.35733,-9.43091 m -35.64871,-53.88544 c -3.1236,3.13297 -6.24717,6.26596 -9.37077,9.39892 m 18.74153,-18.80103 c -3.12358,3.13405 -6.24718,6.26806 -9.37076,9.40211 m 18.74185,-18.80423 c -3.12368,3.13405 -6.2474,6.26807 -9.37109,9.40212 m 18.7409,-18.80424 c -3.12327,3.13405 -6.24654,6.26807 -9.36981,9.40212 M 699.00708,528.87319 c 2.9922,-2.99969 5.98444,-5.99935 8.97664,-8.99903 m -17.95328,17.99806 c 2.9922,-2.99969 5.98444,-5.99934 8.97664,-8.99903 M 681.057,546.87126 c 2.99114,-2.99969 5.98229,-5.99935 8.97344,-8.99904 m -17.95008,17.99807 c 2.9922,-2.99969 5.98443,-5.99934 8.97664,-8.99903 m -17.95328,17.99806 c 2.9922,-2.99968 5.98443,-5.99934 8.97664,-8.99903 m -17.95009,17.99807 c 2.99115,-2.99969 5.9823,-5.99935 8.97345,-8.99904 m -17.95009,17.99807 c 2.99221,-2.99969 5.98444,-5.99934 8.97664,-8.99903 m -17.95328,17.99487 c 2.99221,-2.9986 5.98444,-5.99724 8.97664,-8.99584 m -17.95328,17.99487 c 2.99221,-2.99969 5.98444,-5.99934 8.97664,-8.99903 m -17.95008,17.99807 c 2.99115,-2.99969 5.9823,-5.99935 8.97344,-8.99904 m -17.95008,17.99807 c 2.9922,-2.99969 5.98444,-5.99935 8.97664,-8.99903 m -17.95328,17.99806 c 2.9922,-2.99968 5.98444,-5.99934 8.97664,-8.99903 m -30.8616,-48.30943 c -3.02739,3.0274 -6.05482,6.05482 -9.08221,9.08222 m 18.16122,-18.16123 c -3.02633,3.02634 -6.05267,6.05268 -9.07901,9.07901 m 18.16122,-18.16122 c -3.02739,3.0274 -6.05481,6.05482 -9.08221,9.08221 m 18.16122,-18.16122 c -3.02633,3.02634 -6.05267,6.05268 -9.07901,9.07901 m 18.16122,-18.16122 c -3.02739,3.02739 -6.05481,6.05482 -9.08221,9.08221 m 18.16442,-18.16122 c -3.02739,3.02634 -6.05481,6.05267 -9.08221,9.07901 m 18.16123,-18.16122 c -3.02634,3.02739 -6.05268,6.05482 -9.07902,9.08221 m 18.16123,-18.16442 c -3.0274,3.02739 -6.05482,6.05482 -9.08221,9.08221 m 18.16122,-18.16122 c -3.02634,3.02634 -6.05268,6.05267 -9.07901,9.07901 m 18.16122,-18.16122 c -3.0274,3.02739 -6.05482,6.05482 -9.08221,9.08221 m 18.16442,-18.16122 c -3.0274,3.02633 -6.05482,6.05267 -9.08221,9.07901 m 18.16122,-18.16122 c -3.02634,3.02739 -6.05268,6.05481 -9.07901,9.08221 M 325.82389,908.92162 c -3.02314,3.44647 -6.04627,6.89298 -9.06942,10.33945 m 55.86248,-57.4972 c -3.11911,3.14364 -6.23823,6.28726 -9.35734,9.43091 M 493.90716,735.77419 C 453.47709,777.77076 413.04702,819.7673 372.61695,861.76387 M 484.9849,727.27102 c 2.9741,2.83439 5.94816,5.66878 8.92226,8.50317 m -1.15487,-17.00635 c -2.58912,2.83439 -5.17827,5.66879 -7.76739,8.50318 m 15.53478,-1.46838 c -2.58912,-2.34494 -5.17827,-4.68987 -7.76739,-7.0348 m 107.52134,-90.90848 c -33.25132,32.64775 -66.50264,65.29553 -99.75395,97.94328 M 716.95716,510.87512 c -2.99115,2.99969 -5.98229,5.99935 -8.97344,8.99904 M 280.79065,864.40631 c -6.04574,6.59972 -12.09149,13.19944 -18.13723,19.79916 m 18.13723,-19.79916 c 3.12368,-3.13405 6.2474,-6.26806 9.37109,-9.40212 M 449.52622,692.43295 C 408.89886,734.08827 368.27153,775.7436 327.64417,817.39892 M 456.9609,699.60531 c -2.47824,-2.39078 -4.95645,-4.78158 -7.43468,-7.17236 m 15.92186,-1.31163 c -2.82905,2.828 -5.65813,5.65599 -8.48718,8.48399 m 2.4505,-14.25514 c 2.01222,1.92371 4.02445,3.84745 6.03668,5.77115 m 94.77617,-102.40599 c -33.60427,32.21161 -67.20858,64.42323 -100.81285,96.63484 m 100.81285,-96.63484 c 3.02739,-3.0274 6.05482,-6.05482 9.08221,-9.08221 M 681.00581,474.1272 c -0.9096,-1.15487 -1.81922,-2.30974 -2.72882,-3.46461"
    />
  </g>
);
const Marches = () => (
  <g>
    <path
      className="marches"
      id="marches"
      d="m 290.16175,855.0042 45.01947,44.48652 m -35.6487,-53.88542 45.00923,44.45453 m -35.63846,-53.85665 44.99582,44.42253 m -35.62474,-53.82466 44.98526,44.39376 m -35.61545,-53.79588 44.97278,44.36496 m 196.68951,-282.13075 39.94381,39.22719 m 59.94772,-139.11552 38.78574,40.12936 m -47.86794,-31.05036 38.8913,40.0494 m -47.97353,-30.96717 38.9969,39.96617 m -48.0759,-30.88717 39.10246,39.88621 m -48.18466,-30.80401 39.20803,39.80304 m -48.28703,-30.72081 39.31036,39.71985 m -48.39259,-30.64085 39.41915,39.63988 m -48.50138,-30.55768 39.52475,39.55672 m -48.60376,-30.47772 39.62712,39.47356 m -48.70932,-30.39132 39.73268,39.39035 m -48.81171,-30.31135 39.83828,39.31039 m -58.00268,-21.14596 40.04937,39.14403 m 80.73219,-153.73215 35.95135,36.74792 m -251.50907,180.2462 27.30419,27.64652 m -35.79138,-19.16254 28.02399,27.66569"
    />
  </g>
);

const Scenes = () => (
  <g className="scene">
    <path
      id="TARQ114a"
      d="m 816.10728,206.83629 -8.00557,8.00362 8.01924,6.12478 14.28659,14.23581 -8.00948,9.69301 5.98808,7.11302 48.54707,57.65613 47.60571,58.78499 -18.11459,16.32363 -7.21263,6.49977 5.76346,7.50168 22.24334,28.95207 6.00565,7.99581 8.11689,-6.02517 -6.25954,-8.14815 -22.30779,-29.03606 18.14388,-16.35097 7.36301,-6.63453 -6.24,-7.7048 -47.39673,-58.52523 -49.22479,-58.46273 2.19718,-2.65812 6.30252,-7.62862 -20.54223,-20.46801 z"
    />
    <path
      id="TARQ114b"
      d="m 927.2185,427.7248 -48.51582,36.00456 -8.13252,6.03494 5.70292,8.13057 13.78075,19.64382 -31.04771,20.99729 -23.06947,14.7983 -11.55819,-19.57742 -6.02126,-10.19885 -7.84933,6.72631 -16.04239,13.74756 -14.02898,8.98467 4.73163,7.92682 14.96512,-10.11096 8.32782,-5.6248 7.34739,-6.29664 11.87066,20.1067 4.92171,8.33759 8.2829,-5.31426 23.62414,-15.15376 31.18443,-21.09104 8.38837,-5.67362 -5.63456,-8.03095 -14.0991,-20.09889 48.87714,-36.27213 z"
    />
    <path
      id="TARQ114c"
      d="m 935.0815,421.54729 -7.863,6.17751 -48.51582,36.00456 5.64433,8.26338 48.87714,-36.27213 8.11689,-6.02517 z m -124.57363,88.73703 -16.04239,13.74756 -14.02898,8.98467 4.73245,7.92683 14.9643,-10.11097 8.32782,-5.6248 7.34739,-6.29664 z"
    />
    <path
      id="TARQ114d"
      d="m 816.10728,206.83629 -8.00557,8.00362 -24.11437,24.11436 -29.49308,25.1905 -41.25046,34.32298 7.60911,6.67749 40.08644,-33.35426 29.84071,-25.48736 25.34089,-25.33893 7.2556,-6.88647 z"
    />
    <path
      id="TARQ115entree"
      d="m 260.52577,483.19351 -6.66187,-7.47045 -19.70829,19.24152 -6.64428,7.51339 7.47043,5.65605 z m -19.48563,-21.84881 -6.66187,-7.47045 -31.1356,30.22742 8.29072,6.27712 7.03295,-7.21654 z"
    />
    <path
      id="TARQ115b"
      d="m 150.89104,370.67022 -7.27317,7.24388 7.57785,6.34352 83.18255,69.61663 7.28489,-6.9431 -83.23138,-69.65765 z"
    />
    <path
      id="TARQ115c"
      d="m 267.95517,476.48281 -7.42941,6.7107 48.11155,58.93927 6.2986,7.71653 7.06028,-6.68531 35.56318,-33.67066 -7.27318,-6.88452 -34.40891,32.5789 z"
    />
    <path
      id="TARQ115d"
      d="m 305.9831,221.20882 -7.24779,6.54858 6.91382,7.23217 48.13303,47.93967 53.56253,53.12895 7.02708,-7.11498 -53.54104,-53.1055 -47.79514,-47.60571 z"
    />
    <path
      id="TARQ115e"
      d="m 305.9831,221.20882 -7.24779,6.54858 -46.94556,42.4223 -100.89871,100.49052 -7.27317,7.24388 7.57785,6.34352 c 1.80118,-1.75894 7.23606,-6.98412 7.23606,-6.98412 l 100.24248,-99.8382 46.97487,-42.44573 7.38646,-6.75757 z"
    />
    <path
      id="TARQ115f"
      d="m 364.96535,502.72796 -7.40598,6.76538 70.28067,65.732 14.37253,9.85902 5.53105,3.11317 8.63836,4.86506 4.86896,-7.93722 0.31835,-0.45896 -8.63446,-5.0213 -0.0625,0.0156 0.0234,-0.0371 -5.39238,-3.03504 -13.38428,-9.18132 z"
    />
    <path
      id="TARQ116a"
      d="m 563.22266,172.08984 -6.74805,7.26954 -61.57227,66.33593 3.62696,4.38477 -84.15821,78.86328 6.9961,7.14844 90.85937,-85.14258 -4.0332,-4.875 55.31445,-59.5918 26.69336,26.57617 6.87695,-7.26367 L 570.25,179.08789 Z m 49.38024,18.34274 -6.61695,6.54859 -8.90788,8.81414 7.1931,6.95093 8.7243,-8.63251 51.1544,45.12923 -6.3943,7.68722 7.59738,6.50563 6.64625,-7.98994 6.05056,-7.27513 -7.43723,-6.56032 -50.83801,-44.8519 z"
    />
  </g>
);

const Compass = () => (
  <g id="cone-vision">
    <path id="cone" d="M16 32 A16 16 0 0 1 32 16 L 32 32 Z" />
    <circle id="cercle" cx="32" cy="32" r="4" />
  </g>
);

function CreatePlan() {
  return (
    <div id="plan">
      <svg
        id="orco"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 1122.24 1122.24"
        width="100%"
        height="100%"
        preserveAspectRatio="xMidYMid meet"
      >
        <Parois />
        <Lignes />
        <Escalier />
        <Marches />
        <Scenes />
      </svg>
    </div>
  );
}

const SetupCompass = () => {
  const position = useStore((state) => state.position);

  const pos = useMemo(() => position, [position]);

  const camX = pos.x;
  // const camY = pos.y;
  const camZ = pos.z;

  // console.log(position)

  let posX = normalize(xmin, xmax, camX);
  let posZ = normalize(ymin, ymax, camZ);

  let dim = 495;

  let x = posX * dim - 32;
  let y = (1 - posZ) * dim + 32;

  return (
    <div id="compass" style={{ left: x, bottom: y }}>
      <svg width="64" height="64" xmlns="http://www.w3.org/2000/svg">
        <Compass />
      </svg>
    </div>
  );
};

function normalize(min, max, val) {
  return (val - min) / (max - min);
}

export default function CreatePlanSvg() {
  return (
    <div id="plan-svg">
      <CreatePlan />
      <SetupCompass />
    </div>
  );
}
